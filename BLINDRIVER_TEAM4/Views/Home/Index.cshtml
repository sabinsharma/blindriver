@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Home Page";
}

<section id="main_content">
    <div id="mainCarConate" class="hidden-xs row">
        <!-- Carousel part **PC and Tablet-->
        <div id="mainCarousel" class="carousel slide col-sm-9" data-ride="carousel">
            <ol class="carousel-indicators">
                <li class="active" data-target="#mainCarousel" data-slide-to="0"></li>
                <li data-target="#mainCarousel" data-slide-to="1"></li>
                <li data-target="#mainCarousel" data-slide-to="2"></li>
            </ol>
            <div class="carousel-inner" role="listbox">
                <div class="item active">
                    <img src="~/image/sample1.png" alt="First slide">
                </div>
                <div class="item">
                    <img src="~/image/sample2.png" alt="Second slide">
                </div>
                <div class="item">
                    <img src="~/image/Sample3.png" alt="Third slide">
                </div>
            </div>
        </div>
        <!--END #mainCarousel-->
        <!-- Donate part -->
        <section id="main_donate" class="hidden-xs col-sm-3">
            <h3>Donate Now!</h3>
            <p>Your tribute gift in memory of a loved one or in celebration of a milestone will make a difference in our community.</p>
            <a href="#" class="main_donate_btn">Donation</a>
        </section>
        <!--END #main_donate Hiddn part of mobile-->
    </div>
    <!--END #mainCarDonate-->
    <section id="mainFourbox" class="col-xs-12">
        <div class="mainForbox_container">
            <div class="mainFourbox_box">
                <a href="#">
                    <i class="fa fa-clock-o fa-5x" aria-hidden="true"></i>
                    <h2>ER Wait Time</h2>
                    <p class="hidden-xs">Lorem ipsum dolor sit amet, consectetur adipiscing elit,</p>
                </a>
            </div>
            <div class="mainFourbox_box">
                <a id="livechat">
                    <i class="fa fa-comments fa-5x" aria-hidden="true"></i>
                    <h2>Live Chat</h2>
                    <p class="hidden-xs">Lorem ipsum dolor sit amet, consectetur adipiscing elit,</p>
                </a>
            </div>
            <div class="mainFourbox_box">
                <a href="#">
                    <i class="fa fa-h-square fa-5x" aria-hidden="true"></i>
                    <h2>Find Faciliy</h2>
                    <p class="hidden-xs">Lorem ipsum dolor sit amet, consectetur adipiscing elit,</p>
                </a>
            </div>
            <div class="mainFourbox_box">
                <a href="#">
                    <i class="fa fa-user-md fa-5x" aria-hidden="true"></i>
                    <h2>Self Diagnosis</h2>
                    <p class="hidden-xs">Lorem ipsum dolor sit amet, consectetur adipiscing elit,</p>
                </a>
            </div>
        </div>
    </section>
    <!--END #mainFourbox-->
    <!--Easylink part PC/tablet-->
    <section id="mainEasylink" class="row hidden-xs">
        <div class="col-xs-12 col-sm-4">
            <h3>I need...</h3>
            <ul>
                <li><a href="#">Directions</a></li>
                <li><a href="#">To find a Doctor</a></li>
                <li><a href="#">Visitor Information</a></li>
                <li><a href="#">Senious Services</a></li>
            </ul>
        </div>
        <div class="col-xs-12 col-sm-4">
            <h3>I have...</h3>
            <ul>
                <li><a href="#">Clitical Appointment</a></li>
                <li><a href="#">Prescription</a></li>
                <li><a href="#">Unpaid Invoice</a></li>
                <li><a href="#">Surgery</a></li>
            </ul>
        </div>
        <div class="col-xs-12 col-sm-4">
            <h3>How do I ...</h3>
            <ul>
                <li><a href="@Url.Action("Create","Members")">Register</a></li>
                <li><a href="#">Volunteer</a></li>
                <li><a href="#">Get job</a></li>
                <li><a href="#">Find a Hospital</a></li>
            </ul>
        </div>
    </section>
    <!--END #mainEasylink **PC/tablet-->
    <!--Easylink part **mobile-->
    <section id="easyLinkAccordion" class="visible-xs-block col-xs-12">
        <div class="panel easyLinkPanel">
            <div class="panel-heading">
                <h3 class="panel-title">
                    <a data-toggle="collapse" href="#easyLinkColl1">
                        I need... <span class="caret">
                    </a>
                </h3>
            </div>
            <div id="easyLinkColl1" data-parent="#easyLinkAccordion" class="panel-collapse collapse">
                <ul class="list-group easyLinkList">
                    <li><a href="#">Directions</a></li>
                    <li><a href="#">To find a Doctor</a></li>
                    <li><a href="#">Visitor Information</a></li>
                    <li><a href="#">Senious Services</a></li>
                </ul>
            </div>
        </div>
        <div class="panel easyLinkPanel">
            <div class="panel-heading">
                <h3 class="panel-title">
                    <a data-toggle="collapse" href="#easyLinkColl2">
                        I have... <span class="caret">
                    </a>
                </h3>
            </div>
            <div id="easyLinkColl2" data-parent="#easyLinkAccordion" class="panel-collapse collapse">
                <ul class="list-group easyLinkList">
                    <li><a href="#">Clitical Appointment</a></li>
                    <li><a href="#">Prescription</a></li>
                    <li><a href="#">Unpaid Invoice</a></li>
                    <li><a href="#">Surgery</a></li>
                </ul>
            </div>
        </div>
        <div class="panel easyLinkPanel">
            <div class="panel-heading">
                <h3 class="panel-title">
                    <a data-toggle="collapse" href="#easyLinkColl3">
                        How do I ... <span class="caret">
                    </a>
                </h3>
            </div>
            <div id="easyLinkColl3" data-parent="#easyLinkAccordion" class="panel-collapse collapse">
                <ul class="list-group easyLinkList">
                    <li><a href="#">Register</a></li>
                    <li><a href="#">Volunteer</a></li>
                    <li><a href="#">Get job</a></li>
                    <li><a href="#">Find a Hospital</a></li>
                </ul>
            </div>
        </div>
    </section>
    <!--END #mainEasylink mobile-->
</section>

<div id="chatbox">
    <div style="width: 100%; border: solid 1px Red; height: 40px; display:none;" >
        <h3 style="margin: 10px 0px 0px 10px">
            <span id="spnName" style="display:none;"></span>
            <span id="connID" style="display:none;"></span>
            <span id="usersCount" style="display:none;"></span>
            <span id="adminID" style="display:none;"></span>
        </h3>
    </div>
    <div style="width: 100%; border: solid 1px gray; height: 100%">
        <div style="height: auto; display:none" id="divUsers"></div>
        <div style="height: 90%" id="divChat"></div>
        <div style="border: solid 1px gray;">
            <div style="float: left; width: 20%; padding: 4px; display:none;">
                <input type="text" style="width: 100%" id="txtTo" />
            </div>
            <div style="float: left; width: 75%; padding: 1px">
                <input type="text" style="width: 100%" id="txtMsg" />
            </div>
            <div style="float: right; width: 25%; padding: 1px">
                <input type="button" id="btnSend" value="Send" style="width: 70px" />
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $("#livechat").click(function () {
            $("#chatbox").toggle("fast", function () {
                
            });
        });
    });
</script>

<style>
    #chatbox {
        width: 300px;
        height: 300px;
        background: white;
        border: 1px solid black;
        position: fixed;
        bottom: 10px;
        right: 15px;
        z-index: 1;
        display: none;
        /*overflow-y: scroll;*/
    }
    #divChat {
        overflow-y: scroll;
    }
</style>

@section scripts {
    <!--Add reference to the JQuery file-->
    <script src="~/Scripts/jquery-1.10.2.min.js"></script>
    <!-- Add reference to the minified version of the SignarR client library -->
    <script src="~/Scripts/jquery.signalR-2.2.1.min.js"></script>
    <!-- Add reference to the auto-generated proxy file -->
    <script src="~/signalr/hubs"></script>

    <script>

        $(document).ready(function () {
            $("#txtMsg").keyup(function (event) {
                if (event.keyCode == 13) {
                    if ($("#txtMsg").val() !== "")
                    {
                        chatProxy.server.privatemessage($("#spnName").text(), $("#txtMsg").val(), $("#adminID").text());
                        $('#txtMsg').val('').focus();
                    }
                }
            });

            //var _name = window.prompt("Please Enter your name");
            $("#spnName").text("You");
            $('#txtMsg').val('');

            var chatProxy = $.connection.chatHub;

            // Call the hubconnect method which saves user details at server and bind the btnClick event when connection to the hub is started

            $.connection.hub.start().done(function () {
                try {
                    chatProxy.server.hubconnect($("#spnName").text(), $("#connID").text(), $("#connID").text());
                } catch (e) { alert(e.message); }

                $("#btnSend").click(function () {
                    chatProxy.server.privatemessage($("#spnName").text(), $("#txtMsg").val(), $("#adminID").text());
                    $('#txtMsg').val('').focus();
                })
            })

            chatProxy.client.receiveMessage = function (msgFrom, msg, senderid) {
                if (msgFrom == "NewConnection") {
                    $('#divUsers').append('<li>' + msg + '</li>')
                }
                else if (msgFrom == "ChatHub") {
                    $("#connID").text(msg);
                    $("#adminID").text(senderid);
                }
                else if (msgFrom == "AdminOnline") {
                    //$("#connID").text(msg);
                    $("#adminID").text(senderid);
                }
                else if (msgFrom == "RU") {
                    //this will displays the result of record update in database at server side and update the list of online users
                    var online = senderid.split('#');
                    var length = online.length;
                    for (var i = 0; i < length; i++) {
                        $('#divUsers').append('<li>' + online[i] + '</li>')
                    }

                    $('#divChat').append('<li><strong>' + msgFrom
                        + '</strong>:&nbsp;&nbsp;' + msg + '</li>')
                }
                else {
                    //it displays the message in message window while connection id of sender in a textbox,
                    $("#txtTo").val(senderid);
                    $('#divChat').append('<p style="border:1px solid gray;margin:5px;border-radius: 20px;background-color: floralwhite;padding: 5px;"><strong>' + msgFrom
                        + '</strong>:&nbsp;&nbsp;' + msg + '</p>')
                }
            }
        });
    </script>
}


















